-- 1 --

--SELECT d.department_name,
--COUNT(e.employee_id) AS employee_cnt,
--ROUND(AVG(e.salary)) FROM employees e 
--JOIN departments d ON e.department_id = d.department_id
--GROUP BY d.department_id, d.department_name
--HAVING AVG(e.salary) > 7000
--ORDER BY AVG(e.salary);

-- 2 --

--SELECT e.first_name ||' '|| e.last_name AS employee, 
--d.department_name,
--date_part('day', e.hire_date)
--FROM employees e JOIN departments d ON
--e.department_id = d.department_id
--WHERE e.phone_number IS NULL;

-- 3 -- 
--SELECT e.employee_id,  d.department_name
--FROM employees e JOIN departments d ON
--e.department_id = d.department_id
--WHERE UPPER(d.department_name) LIKE 'IT' 
--AND e.salary > 5000;

-- 4 -- 
SELECT e.department_id,
COUNT(e.employee_id) AS employee_cnt,
c.country_name, l.city
FROM employees e JOIN departments d ON
d.department_id = e.department_id
JOIN locations l ON d.location_id = l.location_id
JOIN countries c ON l.country_id = c.country_id
GROUP BY e.department_id, c.country_name, l.city;
